(()=>{var e={};e.id=698,e.ids=[698],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},55511:e=>{"use strict";e.exports=require("crypto")},14985:e=>{"use strict";e.exports=require("dns")},94735:e=>{"use strict";e.exports=require("events")},29021:e=>{"use strict";e.exports=require("fs")},81630:e=>{"use strict";e.exports=require("http")},73496:e=>{"use strict";e.exports=require("http2")},91645:e=>{"use strict";e.exports=require("net")},21820:e=>{"use strict";e.exports=require("os")},33873:e=>{"use strict";e.exports=require("path")},19771:e=>{"use strict";e.exports=require("process")},27910:e=>{"use strict";e.exports=require("stream")},34631:e=>{"use strict";e.exports=require("tls")},79551:e=>{"use strict";e.exports=require("url")},28354:e=>{"use strict";e.exports=require("util")},74075:e=>{"use strict";e.exports=require("zlib")},69474:(e,r,s)=>{"use strict";s.r(r),s.d(r,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>l});var t=s(70260),a=s(28203),i=s(25155),n=s.n(i),o=s(67292),d={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>o[e]);s.d(r,d);let l=["",{children:["admin",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,17949)),"/Users/mateuszkantarewicz/Desktop/kivvly/src/app/admin/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,71354)),"/Users/mateuszkantarewicz/Desktop/kivvly/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,19937,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/Users/mateuszkantarewicz/Desktop/kivvly/src/app/admin/page.tsx"],u={require:s,loadChunk:()=>Promise.resolve()},p=new t.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/admin/page",pathname:"/admin",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},27809:(e,r,s)=>{Promise.resolve().then(s.bind(s,17949))},40961:(e,r,s)=>{Promise.resolve().then(s.bind(s,73161))},73161:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>A});var t=s(45512),a=s(58009),i=s(79334),n=s(59180),o=s(54716),d=s(17656),l=s(77141),c=s(44195);let u=a.forwardRef(({className:e,...r},s)=>(0,t.jsx)("div",{className:"w-full overflow-auto",children:(0,t.jsx)("table",{ref:s,className:(0,c.cn)("w-full caption-bottom text-sm",e),...r})}));u.displayName="Table";let p=a.forwardRef(({className:e,...r},s)=>(0,t.jsx)("thead",{ref:s,className:(0,c.cn)("[&_tr]:border-b",e),...r}));p.displayName="TableHeader";let m=a.forwardRef(({className:e,...r},s)=>(0,t.jsx)("tbody",{ref:s,className:(0,c.cn)("[&_tr:last-child]:border-0",e),...r}));m.displayName="TableBody",a.forwardRef(({className:e,...r},s)=>(0,t.jsx)("tfoot",{ref:s,className:(0,c.cn)("bg-primary font-medium text-primary-foreground",e),...r})).displayName="TableFooter";let x=a.forwardRef(({className:e,...r},s)=>(0,t.jsx)("tr",{ref:s,className:(0,c.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...r}));x.displayName="TableRow";let h=a.forwardRef(({className:e,...r},s)=>(0,t.jsx)("th",{ref:s,className:(0,c.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...r}));h.displayName="TableHead";let f=a.forwardRef(({className:e,...r},s)=>(0,t.jsx)("td",{ref:s,className:(0,c.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...r}));f.displayName="TableCell",a.forwardRef(({className:e,...r},s)=>(0,t.jsx)("caption",{ref:s,className:(0,c.cn)("mt-4 text-sm text-muted-foreground",e),...r})).displayName="TableCaption";let v=(0,s(21643).F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function g({className:e,variant:r,...s}){return(0,t.jsx)("div",{className:(0,c.cn)(v({variant:r}),e),...s})}var y=s(39400),b=s(41680);let j=(0,b.A)("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),N=(0,b.A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);function k(){let[e,r]=(0,a.useState)([]),[s,i]=(0,a.useState)(null),n=async e=>{try{await (0,d.mZ)((0,d.H9)(l.db,"remoteWorkLocations",e),{status:"approved"}),r(r=>r.map(r=>r.id===e?{...r,status:"approved"}:r)),i("Place approved successfully!")}catch(e){console.error("Error approving place:",e),i("Error approving place. Please try again.")}},o=async e=>{try{await (0,d.mZ)((0,d.H9)(l.db,"remoteWorkLocations",e),{status:"rejected"}),r(r=>r.map(r=>r.id===e?{...r,status:"rejected"}:r)),i("Place rejected successfully!")}catch(e){console.error("Error rejecting place:",e),i("Error rejecting place. Please try again.")}},c=e=>{console.log("Edit place with ID:",e)},v=async e=>{try{await (0,d.kd)((0,d.H9)(l.db,"remoteWorkLocations",e)),r(r=>r.filter(r=>r.id!==e)),i("Place deleted successfully!")}catch(e){console.error("Error deleting place:",e),i("Error deleting place. Please try again.")}};return(0,t.jsxs)("div",{children:[s&&(0,t.jsx)("p",{className:"mb-2 text-sm text-gray-600",children:s}),(0,t.jsxs)(u,{children:[(0,t.jsx)(p,{children:(0,t.jsxs)(x,{children:[(0,t.jsx)(h,{children:"Name"}),(0,t.jsx)(h,{children:"Status"}),(0,t.jsx)(h,{children:"Amenities"}),(0,t.jsx)(h,{children:"Actions"})]})}),(0,t.jsxs)(m,{children:[e.map(e=>(0,t.jsxs)(x,{children:[(0,t.jsx)(f,{children:e.name}),(0,t.jsx)(f,{children:(0,t.jsx)(g,{variant:"approved"===e.status?"default":"pending"===e.status?"secondary":"destructive",children:e.status})}),(0,t.jsx)(f,{children:e.amenities&&e.amenities.length>0?e.amenities.join(", "):"â€”"}),(0,t.jsx)(f,{children:(0,t.jsxs)("div",{className:"flex space-x-2",children:["pending"===e.status&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(y.$,{onClick:()=>n(e.id),size:"sm",children:"Approve"}),(0,t.jsx)(y.$,{onClick:()=>o(e.id),variant:"destructive",size:"sm",children:"Reject"})]}),(0,t.jsx)(y.$,{onClick:()=>c(e.id),variant:"outline",size:"icon",children:(0,t.jsx)(j,{className:"h-4 w-4"})}),(0,t.jsx)(y.$,{onClick:()=>v(e.id),variant:"outline",size:"icon",children:(0,t.jsx)(N,{className:"h-4 w-4"})})]})})]},e.id)),0===e.length&&(0,t.jsx)(x,{children:(0,t.jsx)(f,{colSpan:4,children:(0,t.jsx)("p",{className:"text-center text-gray-500",children:"No places found."})})})]})]})]})}var w=s(45103);function P(){let[e,r]=(0,a.useState)([]),[s,i]=(0,a.useState)(!0),[c,u]=(0,a.useState)(null),{profile:p}=(0,n.Q)(),{toast:m}=(0,o.dj)(),x=async(e,s)=>{console.log(`Toggling admin status for user ${e} to ${s}`);try{await (0,d.mZ)((0,d.H9)(l.db,"users",e),{isAdmin:s}),r(r=>r.map(r=>r.id===e?{...r,isAdmin:s}:r)),u(`Updated admin role for user: ${e}`),m({title:"Success",description:`Admin role for user ${e} updated successfully.`})}catch(e){console.error("Error updating admin role:",e),u("Error updating admin role. Please try again."),m({title:"Error",description:"Failed to update admin role.",variant:"destructive"})}},h=async(e,s)=>{console.log(`Toggling ban status for user ${e} to ${s}`);try{await (0,d.mZ)((0,d.H9)(l.db,"users",e),{isBanned:s}),r(r=>r.map(r=>r.id===e?{...r,isBanned:s}:r)),u(`User ${e} is now ${s?"banned":"unbanned"}.`),m({title:"Success",description:`User ${e} has been ${s?"banned":"unbanned"}.`})}catch(e){console.error("Error updating ban status:",e),u("Error updating ban status. Please try again."),m({title:"Error",description:"Failed to update ban status.",variant:"destructive"})}},f=async e=>{console.log(`Removing user ${e} from Firestore`);try{await (0,d.kd)((0,d.H9)(l.db,"users",e)),r(r=>r.filter(r=>r.id!==e)),u(`User ${e} removed from Firestore.`),m({title:"Success",description:`User ${e} has been removed.`})}catch(e){console.error("Error removing user:",e),u("Error removing user. Please try again."),m({title:"Error",description:"Failed to remove user.",variant:"destructive"})}};return s?(0,t.jsx)("div",{className:"flex items-center justify-center p-8 bg-gray-100 rounded-lg",children:(0,t.jsx)("div",{className:"w-6 h-6 border-2 border-blue-600 border-t-transparent border-solid rounded-full animate-spin"})}):c&&0===e.length?(console.log("Status Message:",c),(0,t.jsxs)("div",{className:"text-center p-8 bg-gray-100 rounded-lg",children:[(0,t.jsx)("p",{className:"mb-4 text-gray-600",children:c}),(0,t.jsx)("p",{className:"text-gray-500",children:"No users found."})]})):(0,t.jsxs)("div",{className:"space-y-4",children:[c&&e.length>0&&(0,t.jsx)("p",{className:"text-sm text-gray-600 border p-2 rounded-md",children:c}),0===e.length?(0,t.jsx)("div",{className:"text-center p-8 bg-gray-100 rounded-lg",children:(0,t.jsx)("p",{className:"text-gray-500",children:"No users found."})}):e.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border border-gray-300 rounded-md shadow-sm",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)(w.default,{src:e.avatarUrl||"https://via.placeholder.com/64?text=No+Avatar",alt:`${e.displayName||e.email} avatar`,className:"w-12 h-12 rounded-full object-cover",width:48,height:48}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-bold",children:e.displayName||e.email||"No display name"}),e.email&&(0,t.jsxs)("p",{className:"text-xs text-gray-600",children:["Email: ",e.email]}),(0,t.jsxs)("p",{className:"text-xs text-gray-600",children:["Occupation: ",e.jobOccupation||"N/A"]}),(0,t.jsxs)("p",{className:"text-xs text-gray-600",children:["Admin: ",e.isAdmin?"Yes":"No"]}),(0,t.jsxs)("p",{className:"text-xs text-gray-600",children:["Banned: ",e.isBanned?"Yes":"No"]})]})]}),(0,t.jsxs)("div",{className:"space-x-2",children:[e.id!==p?.uid&&(0,t.jsx)(y.$,{onClick:()=>x(e.id,!e.isAdmin),variant:"outline",children:e.isAdmin?"Remove Admin":"Make Admin"}),e.id!==p?.uid&&(0,t.jsx)(y.$,{onClick:()=>h(e.id,!e.isBanned),variant:"outline",children:e.isBanned?"Unban":"Ban"}),e.id!==p?.uid&&(0,t.jsx)(y.$,{onClick:()=>f(e.id),variant:"destructive",children:"Remove"})]})]},e.id))]})}function A(){(0,i.useRouter)();let{user:e,profile:r,loading:s}=(0,n.Q)(),{toast:a}=(0,o.dj)();return!s&&e&&r?.isAdmin?(0,t.jsxs)("div",{className:"container mx-auto py-8 mt-[100px] space-y-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Admin Dashboard"}),(0,t.jsxs)("section",{children:[(0,t.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"All Places"}),(0,t.jsx)(k,{})]}),(0,t.jsxs)("section",{children:[(0,t.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"All Users"}),(0,t.jsx)(P,{})]})]}):(0,t.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,t.jsx)("div",{className:"w-6 h-6 border-2 border-blue-600 border-t-transparent border-solid rounded-full animate-spin"})})}},17949:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>t});let t=(0,s(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/mateuszkantarewicz/Desktop/kivvly/src/app/admin/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/mateuszkantarewicz/Desktop/kivvly/src/app/admin/page.tsx","default")},70440:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>a});var t=s(88077);let a=async e=>[{type:"image/x-icon",sizes:"48x48",url:(0,t.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]}};var r=require("../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[989,44,77,592],()=>s(69474));module.exports=t})();