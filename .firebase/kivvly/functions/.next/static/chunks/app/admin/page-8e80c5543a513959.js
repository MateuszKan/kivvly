(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{6511:(e,t,r)=>{Promise.resolve().then(r.bind(r,5396))},6046:(e,t,r)=>{"use strict";var s=r(6658);r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})},5396:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>k});var s=r(5155),a=r(2115),n=r(6046),i=r(9730),o=r(5564),d=r(7058),l=r(4595),c=r(1567);let u=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{className:"w-full overflow-auto",children:(0,s.jsx)("table",{ref:t,className:(0,c.cn)("w-full caption-bottom text-sm",r),...a})})});u.displayName="Table";let m=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("thead",{ref:t,className:(0,c.cn)("[&_tr]:border-b",r),...a})});m.displayName="TableHeader";let p=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("tbody",{ref:t,className:(0,c.cn)("[&_tr:last-child]:border-0",r),...a})});p.displayName="TableBody",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("tfoot",{ref:t,className:(0,c.cn)("bg-primary font-medium text-primary-foreground",r),...a})}).displayName="TableFooter";let h=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("tr",{ref:t,className:(0,c.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r),...a})});h.displayName="TableRow";let x=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("th",{ref:t,className:(0,c.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",r),...a})});x.displayName="TableHead";let f=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("td",{ref:t,className:(0,c.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",r),...a})});f.displayName="TableCell",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("caption",{ref:t,className:(0,c.cn)("mt-4 text-sm text-muted-foreground",r),...a})}).displayName="TableCaption";let v=(0,r(1027).F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function g(e){let{className:t,variant:r,...a}=e;return(0,s.jsx)("div",{className:(0,c.cn)(v({variant:r}),t),...a})}var b=r(3312),y=r(7401);let j=(0,y.A)("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),N=(0,y.A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);function w(){let[e,t]=(0,a.useState)([]),[r,n]=(0,a.useState)(null);(0,a.useEffect)(()=>{(async()=>{try{let e=await (0,d.GG)((0,d.rJ)(l.db,"remoteWorkLocations")),r=[];e.forEach(e=>{r.push({id:e.id,...e.data()})}),t(r)}catch(e){console.error("Error fetching places:",e),n("Unable to fetch places. Check console for details.")}})()},[]);let i=async e=>{try{await (0,d.mZ)((0,d.H9)(l.db,"remoteWorkLocations",e),{status:"approved"}),t(t=>t.map(t=>t.id===e?{...t,status:"approved"}:t)),n("Place approved successfully!")}catch(e){console.error("Error approving place:",e),n("Error approving place. Please try again.")}},o=async e=>{try{await (0,d.mZ)((0,d.H9)(l.db,"remoteWorkLocations",e),{status:"rejected"}),t(t=>t.map(t=>t.id===e?{...t,status:"rejected"}:t)),n("Place rejected successfully!")}catch(e){console.error("Error rejecting place:",e),n("Error rejecting place. Please try again.")}},c=e=>{console.log("Edit place with ID:",e)},v=async e=>{try{await (0,d.kd)((0,d.H9)(l.db,"remoteWorkLocations",e)),t(t=>t.filter(t=>t.id!==e)),n("Place deleted successfully!")}catch(e){console.error("Error deleting place:",e),n("Error deleting place. Please try again.")}};return(0,s.jsxs)("div",{children:[r&&(0,s.jsx)("p",{className:"mb-2 text-sm text-gray-600",children:r}),(0,s.jsxs)(u,{children:[(0,s.jsx)(m,{children:(0,s.jsxs)(h,{children:[(0,s.jsx)(x,{children:"Name"}),(0,s.jsx)(x,{children:"Status"}),(0,s.jsx)(x,{children:"Amenities"}),(0,s.jsx)(x,{children:"Actions"})]})}),(0,s.jsxs)(p,{children:[e.map(e=>(0,s.jsxs)(h,{children:[(0,s.jsx)(f,{children:e.name}),(0,s.jsx)(f,{children:(0,s.jsx)(g,{variant:"approved"===e.status?"default":"pending"===e.status?"secondary":"destructive",children:e.status})}),(0,s.jsx)(f,{children:e.amenities&&e.amenities.length>0?e.amenities.join(", "):"â€”"}),(0,s.jsx)(f,{children:(0,s.jsxs)("div",{className:"flex space-x-2",children:["pending"===e.status&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b.$,{onClick:()=>i(e.id),size:"sm",children:"Approve"}),(0,s.jsx)(b.$,{onClick:()=>o(e.id),variant:"destructive",size:"sm",children:"Reject"})]}),(0,s.jsx)(b.$,{onClick:()=>c(e.id),variant:"outline",size:"icon",children:(0,s.jsx)(j,{className:"h-4 w-4"})}),(0,s.jsx)(b.$,{onClick:()=>v(e.id),variant:"outline",size:"icon",children:(0,s.jsx)(N,{className:"h-4 w-4"})})]})})]},e.id)),0===e.length&&(0,s.jsx)(h,{children:(0,s.jsx)(f,{colSpan:4,children:(0,s.jsx)("p",{className:"text-center text-gray-500",children:"No places found."})})})]})]})]})}var A=r(5565);function E(){let[e,t]=(0,a.useState)([]),[r,n]=(0,a.useState)(!0),[c,u]=(0,a.useState)(null),{profile:m}=(0,i.Q)(),{toast:p}=(0,o.dj)();(0,a.useEffect)(()=>{if(!(null==m?void 0:m.isAdmin)){console.log("Access Denied: User is not an admin."),u("Access Denied: You do not have permission to view this section."),n(!1);return}console.log("Fetching users as admin:",null==m?void 0:m.isAdmin);let e=(0,d.rJ)(l.db,"users"),r=(0,d.aQ)(e,e=>{let r=[];e.forEach(e=>{r.push({id:e.id,...e.data()})}),t(r),n(!1),console.log("Fetched Users:",r)},e=>{console.error("Error fetching users:",e),u("Unable to fetch users. Check console for details."),n(!1)});return()=>r()},[m]);let h=async(e,r)=>{console.log("Toggling admin status for user ".concat(e," to ").concat(r));try{await (0,d.mZ)((0,d.H9)(l.db,"users",e),{isAdmin:r}),t(t=>t.map(t=>t.id===e?{...t,isAdmin:r}:t)),u("Updated admin role for user: ".concat(e)),p({title:"Success",description:"Admin role for user ".concat(e," updated successfully.")})}catch(e){console.error("Error updating admin role:",e),u("Error updating admin role. Please try again."),p({title:"Error",description:"Failed to update admin role.",variant:"destructive"})}},x=async(e,r)=>{console.log("Toggling ban status for user ".concat(e," to ").concat(r));try{await (0,d.mZ)((0,d.H9)(l.db,"users",e),{isBanned:r}),t(t=>t.map(t=>t.id===e?{...t,isBanned:r}:t)),u("User ".concat(e," is now ").concat(r?"banned":"unbanned",".")),p({title:"Success",description:"User ".concat(e," has been ").concat(r?"banned":"unbanned",".")})}catch(e){console.error("Error updating ban status:",e),u("Error updating ban status. Please try again."),p({title:"Error",description:"Failed to update ban status.",variant:"destructive"})}},f=async e=>{console.log("Removing user ".concat(e," from Firestore"));try{await (0,d.kd)((0,d.H9)(l.db,"users",e)),t(t=>t.filter(t=>t.id!==e)),u("User ".concat(e," removed from Firestore.")),p({title:"Success",description:"User ".concat(e," has been removed.")})}catch(e){console.error("Error removing user:",e),u("Error removing user. Please try again."),p({title:"Error",description:"Failed to remove user.",variant:"destructive"})}};return r?(0,s.jsx)("div",{className:"flex items-center justify-center p-8 bg-gray-100 rounded-lg",children:(0,s.jsx)("div",{className:"w-6 h-6 border-2 border-blue-600 border-t-transparent border-solid rounded-full animate-spin"})}):c&&0===e.length?(console.log("Status Message:",c),(0,s.jsxs)("div",{className:"text-center p-8 bg-gray-100 rounded-lg",children:[(0,s.jsx)("p",{className:"mb-4 text-gray-600",children:c}),(0,s.jsx)("p",{className:"text-gray-500",children:"No users found."})]})):(0,s.jsxs)("div",{className:"space-y-4",children:[c&&e.length>0&&(0,s.jsx)("p",{className:"text-sm text-gray-600 border p-2 rounded-md",children:c}),0===e.length?(0,s.jsx)("div",{className:"text-center p-8 bg-gray-100 rounded-lg",children:(0,s.jsx)("p",{className:"text-gray-500",children:"No users found."})}):e.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border border-gray-300 rounded-md shadow-sm",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)(A.default,{src:e.avatarUrl||"https://via.placeholder.com/64?text=No+Avatar",alt:"".concat(e.displayName||e.email," avatar"),className:"w-12 h-12 rounded-full object-cover",width:48,height:48}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-bold",children:e.displayName||e.email||"No display name"}),e.email&&(0,s.jsxs)("p",{className:"text-xs text-gray-600",children:["Email: ",e.email]}),(0,s.jsxs)("p",{className:"text-xs text-gray-600",children:["Occupation: ",e.jobOccupation||"N/A"]}),(0,s.jsxs)("p",{className:"text-xs text-gray-600",children:["Admin: ",e.isAdmin?"Yes":"No"]}),(0,s.jsxs)("p",{className:"text-xs text-gray-600",children:["Banned: ",e.isBanned?"Yes":"No"]})]})]}),(0,s.jsxs)("div",{className:"space-x-2",children:[e.id!==(null==m?void 0:m.uid)&&(0,s.jsx)(b.$,{onClick:()=>h(e.id,!e.isAdmin),variant:"outline",children:e.isAdmin?"Remove Admin":"Make Admin"}),e.id!==(null==m?void 0:m.uid)&&(0,s.jsx)(b.$,{onClick:()=>x(e.id,!e.isBanned),variant:"outline",children:e.isBanned?"Unban":"Ban"}),e.id!==(null==m?void 0:m.uid)&&(0,s.jsx)(b.$,{onClick:()=>f(e.id),variant:"destructive",children:"Remove"})]})]},e.id))]})}function k(){let e=(0,n.useRouter)(),{user:t,profile:r,loading:d}=(0,i.Q)(),{toast:l}=(0,o.dj)();return((0,a.useEffect)(()=>{d||(t?(null==r?void 0:r.isAdmin)||(l({title:"Access Denied",description:"You do not have permission to view this page.",variant:"destructive"}),e.push("/login")):(l({title:"Unauthorized",description:"You must be logged in to access the admin dashboard.",variant:"destructive"}),e.push("/login")))},[t,r,d,e,l]),!d&&t&&(null==r?void 0:r.isAdmin))?(0,s.jsxs)("div",{className:"container mx-auto py-8 mt-[100px] space-y-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Admin Dashboard"}),(0,s.jsxs)("section",{children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"All Places"}),(0,s.jsx)(w,{})]}),(0,s.jsxs)("section",{children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"All Users"}),(0,s.jsx)(E,{})]})]}):(0,s.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,s.jsx)("div",{className:"w-6 h-6 border-2 border-blue-600 border-t-transparent border-solid rounded-full animate-spin"})})}},3312:(e,t,r)=>{"use strict";r.d(t,{$:()=>l});var s=r(5155),a=r(2115),n=r(2317),i=r(1027),o=r(1567);let d=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),l=a.forwardRef((e,t)=>{let{className:r,variant:a,size:i,asChild:l=!1,...c}=e,u=l?n.DX:"button";return(0,s.jsx)(u,{className:(0,o.cn)(d({variant:a,size:i,className:r})),ref:t,...c})});l.displayName="Button"},9730:(e,t,r)=>{"use strict";r.d(t,{AuthProvider:()=>l,Q:()=>c});var s=r(5155),a=r(2115),n=r(4595),i=r(399),o=r(7058);let d=(0,a.createContext)({user:null,profile:null,loading:!0}),l=e=>{let{children:t}=e,[r,l]=(0,a.useState)(null),[c,u]=(0,a.useState)(null),[m,p]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{let e=(0,i.hg)(n.j,async e=>{if(p(!0),e){try{await e.reload();let t=(0,o.H9)(n.db,"users",e.uid),r=await (0,o.x7)(t);if(r.exists()){let s=r.data();"no"===s.isVerified&&e.emailVerified&&(await (0,o.mZ)(t,{isVerified:"yes"}),s.isVerified="yes");let a={uid:e.uid,...s};u(a)}else u(null)}catch(e){console.error("Error fetching/updating user doc:",e),u(null)}l(e)}else l(null),u(null);p(!1)});return()=>e()},[]),(0,s.jsx)(d.Provider,{value:{user:r,profile:c,loading:m},children:t})},c=()=>(0,a.useContext)(d)},5564:(e,t,r)=>{"use strict";r.d(t,{dj:()=>m});var s=r(2115);let a=0,n=new Map,i=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,t)},o=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?i(r):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},d=[],l={toasts:[]};function c(e){l=o(l,e),d.forEach(e=>{e(l)})}function u(e){let{...t}=e,r=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>c({type:"DISMISS_TOAST",toastId:r});return c({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||s()}}}),{id:r,dismiss:s,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function m(){let[e,t]=s.useState(l);return s.useEffect(()=>(d.push(t),()=>{let e=d.indexOf(t);e>-1&&d.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},4595:(e,t,r)=>{"use strict";r.d(t,{db:()=>o,j:()=>d});var s=r(9904),a=r(7058),n=r(399);let i=(0,s.Wp)({apiKey:"AIzaSyCzuXne1Zr8WXpmOkuu8cTaY4xMv53mQeQ",authDomain:"kivvly.firebaseapp.com",projectId:"kivvly",storageBucket:"kivvly.firebasestorage.app",messagingSenderId:"413464866352",appId:"1:413464866352:web:61294a4121d0b0b28887f5"}),o=(0,a.aU)(i),d=(0,n.xI)(i)},1567:(e,t,r)=>{"use strict";r.d(t,{cn:()=>n});var s=r(3463),a=r(9795);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.QP)((0,s.$)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[992,523,31,749,441,517,358],()=>t(6511)),_N_E=e.O()}]);