(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{7225:(e,a,s)=>{Promise.resolve().then(s.bind(s,8143))},8143:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>N});var t=s(5155),r=s(2115),i=s(6046),l=s(399),n=s(7058),d=s(9904),o=s(4595),c=s(3312),u=s(3900),m=s(8986),f=s(9749),x=s(8629),g=s(1567);let p=x.bL,h=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(x.B8,{ref:a,className:(0,g.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...r})});h.displayName=x.B8.displayName;let v=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(x.l9,{ref:a,className:(0,g.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...r})});v.displayName=x.l9.displayName;let b=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(x.UC,{ref:a,className:(0,g.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...r})});b.displayName=x.UC.displayName;var y=s(9506),w=s(3415);let j=w.z.object({name:w.z.string().min(3,"Name must be at least 3 characters."),email:w.z.string().email("Invalid email address."),password:w.z.string().regex(/^(?=.*[A-Za-z])(?=.*\d).{8,}$/,"Password must be at least 8 characters including 1 digit.")});function N(){let e=(0,i.useRouter)(),[a,s]=(0,r.useState)(null),[x,g]=(0,r.useState)(null),[N,C]=(0,r.useState)(!1),[F,k]=(0,r.useState)(""),[E,P]=(0,r.useState)(""),[R,B]=(0,r.useState)(""),[S,I]=(0,r.useState)(""),[z,J]=(0,r.useState)("");async function _(a){a.preventDefault(),s(null),g(null),C(!0);try{let a=(await (0,l.x9)(o.j,F,E)).user,t=(0,n.H9)(o.db,"users",a.uid),r=await (0,n.x7)(t);if(r.exists()){let e=r.data();if(e.isBanned){await (0,l.CI)(o.j),s("Your account has been banned.");return}if("no"===e.isVerified){await (0,l.CI)(o.j),s("Please verify your email before logging in.");return}}else{await (0,l.CI)(o.j),s("No user document found. Please contact support.");return}e.push("/")}catch(e){e instanceof d.g?s(e.message||"Failed to log in. Please try again."):e instanceof Error?s(e.message||"Failed to log in. Please try again."):s("Failed to log in. Please try again.")}finally{C(!1)}}async function A(){s(null),g(null),C(!0);try{if(!F)throw Error("Please enter your email in the Email field first.");await (0,l.J1)(o.j,F),g("Password reset link sent to your email!")}catch(e){e instanceof Error?s(e.message||"Failed to send password reset."):s("Failed to send password reset.")}finally{C(!1)}}async function O(e){e.preventDefault(),s(null),g(null),C(!0);try{j.parse({name:R,email:S,password:z});let e=(await (0,l.eJ)(o.j,S,z)).user;await (0,l.r7)(e,{displayName:R}),await (0,l.gA)(e),await (0,n.BN)((0,n.H9)(o.db,"users",e.uid),{email:S,displayName:R,avatarUrl:"/default-avatar.png",isBanned:!1,isVerified:"no",createdAt:(0,n.O5)()}),g("Account created! We sent a verification link to your email.")}catch(e){e instanceof w.G?s(e.issues[0].message):e instanceof d.g&&"auth/email-already-in-use"===e.code?s("This email is already registered. Use another one or reset your password."):e instanceof d.g?s(e.message||"Failed to create account."):e instanceof Error?s(e.message||"Failed to create account."):s("Failed to create account.")}finally{C(!1)}}async function U(){s(null),g(null),C(!0);try{if(!S)throw Error("Please enter your email in the registration form first.");await (0,l.J1)(o.j,S),g("Password reset link sent!")}catch(e){e instanceof Error?s(e.message||"Failed to send password reset."):s("Failed to send password reset.")}finally{C(!1)}}async function $(){s(null),g(null),C(!0);try{let a=new l.HF,t=(await (0,l.df)(o.j,a)).user,r=t.displayName||"No Name";r.length>10&&(r=r.slice(0,10));let i=(0,n.H9)(o.db,"users",t.uid),d=await (0,n.x7)(i);if(d.exists()){if(d.data().isBanned){await (0,l.CI)(o.j),s("Your account has been banned.");return}}else await (0,n.BN)(i,{email:t.email,displayName:r,avatarUrl:t.photoURL||"https://via.placeholder.com/128?text=No+Avatar",isBanned:!1,isVerified:"yes",createdAt:(0,n.O5)()});e.push("/")}catch(e){e instanceof d.g?s(e.message||"Failed to log in with Google."):e instanceof Error?s(e.message||"Failed to log in with Google."):s("Failed to log in with Google.")}finally{C(!1)}}return(0,t.jsx)("div",{className:"relative w-full h-screen flex flex-col bg-gray-100",children:(0,t.jsx)("div",{className:"flex-grow flex items-center justify-center",children:(0,t.jsxs)(f.Zp,{className:"w-[400px]",children:[(0,t.jsxs)(f.aR,{children:[(0,t.jsx)(f.ZB,{children:"Welcome"}),(0,t.jsx)(f.BT,{children:"Login or create an account."})]}),(0,t.jsxs)(f.Wu,{children:[a&&(0,t.jsx)("p",{className:"text-red-600 text-sm mb-4",children:a}),x&&(0,t.jsx)("p",{className:"text-green-600 text-sm mb-4",children:x}),(0,t.jsxs)(p,{defaultValue:"login",className:"w-full",children:[(0,t.jsxs)(h,{className:"grid w-full grid-cols-2",children:[(0,t.jsx)(v,{value:"login",children:"Login"}),(0,t.jsx)(v,{value:"register",children:"Register"})]}),(0,t.jsx)(b,{value:"login",children:(0,t.jsxs)("form",{onSubmit:_,children:[(0,t.jsxs)("div",{className:"grid gap-4",children:[(0,t.jsxs)("div",{className:"flex flex-col space-y-1.5",children:[(0,t.jsx)(m.J,{htmlFor:"loginEmail",children:"Email"}),(0,t.jsx)(u.p,{id:"loginEmail",type:"email",placeholder:"Enter your email",required:!0,value:F,onChange:e=>k(e.target.value)})]}),(0,t.jsxs)("div",{className:"flex flex-col space-y-1.5",children:[(0,t.jsx)(m.J,{htmlFor:"loginPassword",children:"Password"}),(0,t.jsx)(u.p,{id:"loginPassword",type:"password",placeholder:"Enter your password",required:!0,value:E,onChange:e=>P(e.target.value)})]})]}),(0,t.jsx)(c.$,{className:"w-full mt-6",type:"submit",disabled:N,children:N?"Logging in...":"Login"}),(0,t.jsx)("div",{className:"text-center mt-2",children:(0,t.jsx)("button",{type:"button",onClick:A,disabled:N,className:"text-sm text-blue-600 underline",children:"Forgot your password?"})}),(0,t.jsxs)("div",{className:"relative my-4",children:[(0,t.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,t.jsx)("span",{className:"w-full border-t"})}),(0,t.jsx)("div",{className:"relative flex justify-center text-xs uppercase",children:(0,t.jsx)("span",{className:"bg-white px-2 text-muted-foreground",children:"Or continue with"})})]}),(0,t.jsx)("div",{className:"flex flex-col space-y-2",children:(0,t.jsxs)(c.$,{variant:"outline",type:"button",disabled:N,onClick:$,children:[(0,t.jsx)(y.F4b,{className:"mr-2 h-4 w-4"}),"Google"]})})]})}),(0,t.jsx)(b,{value:"register",children:(0,t.jsxs)("form",{onSubmit:O,children:[(0,t.jsxs)("div",{className:"grid gap-4",children:[(0,t.jsxs)("div",{className:"flex flex-col space-y-1.5",children:[(0,t.jsx)(m.J,{htmlFor:"rName",children:"Name"}),(0,t.jsx)(u.p,{id:"rName",placeholder:"Minimum 3 characters",value:R,onChange:e=>B(e.target.value),required:!0})]}),(0,t.jsxs)("div",{className:"flex flex-col space-y-1.5",children:[(0,t.jsx)(m.J,{htmlFor:"rEmail",children:"Email"}),(0,t.jsx)(u.p,{id:"rEmail",type:"email",placeholder:"Enter your email",value:S,onChange:e=>I(e.target.value),required:!0})]}),(0,t.jsxs)("div",{className:"flex flex-col space-y-1.5",children:[(0,t.jsx)(m.J,{htmlFor:"rPassword",children:"Password"}),(0,t.jsx)(u.p,{id:"rPassword",type:"password",placeholder:"Password must be at least 8 characters including 1 digit.",value:z,onChange:e=>J(e.target.value),required:!0})]})]}),(0,t.jsx)(c.$,{className:"w-full mt-6",type:"submit",disabled:N,children:N?"Creating account...":"Create account"}),(0,t.jsx)("div",{className:"text-center mt-2",children:(0,t.jsx)("button",{type:"button",onClick:U,disabled:N,className:"text-sm text-blue-600 underline",children:"Forgot your password?"})}),(0,t.jsxs)("div",{className:"relative my-4",children:[(0,t.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,t.jsx)("span",{className:"w-full border-t"})}),(0,t.jsx)("div",{className:"relative flex justify-center text-xs uppercase",children:(0,t.jsx)("span",{className:"bg-white px-2 text-muted-foreground",children:"Or continue with"})})]}),(0,t.jsx)("div",{className:"flex flex-col space-y-2",children:(0,t.jsxs)(c.$,{variant:"outline",type:"button",disabled:N,onClick:$,children:[(0,t.jsx)(y.F4b,{className:"mr-2 h-4 w-4"}),"Google"]})})]})})]})]})]})})})}},3312:(e,a,s)=>{"use strict";s.d(a,{$:()=>o});var t=s(5155),r=s(2115),i=s(2317),l=s(1027),n=s(1567);let d=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),o=r.forwardRef((e,a)=>{let{className:s,variant:r,size:l,asChild:o=!1,...c}=e,u=o?i.DX:"button";return(0,t.jsx)(u,{className:(0,n.cn)(d({variant:r,size:l,className:s})),ref:a,...c})});o.displayName="Button"},9749:(e,a,s)=>{"use strict";s.d(a,{BT:()=>o,Wu:()=>c,ZB:()=>d,Zp:()=>l,aR:()=>n});var t=s(5155),r=s(2115),i=s(1567);let l=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,i.cn)("rounded-xl border bg-card text-card-foreground shadow",s),...r})});l.displayName="Card";let n=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",s),...r})});n.displayName="CardHeader";let d=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,i.cn)("font-semibold leading-none tracking-tight",s),...r})});d.displayName="CardTitle";let o=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,i.cn)("text-sm text-muted-foreground",s),...r})});o.displayName="CardDescription";let c=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,i.cn)("p-6 pt-0",s),...r})});c.displayName="CardContent",r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,i.cn)("flex items-center p-6 pt-0",s),...r})}).displayName="CardFooter"},3900:(e,a,s)=>{"use strict";s.d(a,{p:()=>l});var t=s(5155),r=s(2115),i=s(1567);let l=r.forwardRef((e,a)=>{let{className:s,type:r,...l}=e;return(0,t.jsx)("input",{type:r,className:(0,i.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:a,...l})});l.displayName="Input"},8986:(e,a,s)=>{"use strict";s.d(a,{J:()=>o});var t=s(5155),r=s(2115),i=s(6195),l=s(1027),n=s(1567);let d=(0,l.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(i.b,{ref:a,className:(0,n.cn)(d(),s),...r})});o.displayName=i.b.displayName},4595:(e,a,s)=>{"use strict";s.d(a,{db:()=>n,j:()=>d});var t=s(9904),r=s(7058),i=s(399);let l=(0,t.Wp)({apiKey:"AIzaSyCzuXne1Zr8WXpmOkuu8cTaY4xMv53mQeQ",authDomain:"kivvly.firebaseapp.com",projectId:"kivvly",storageBucket:"kivvly.firebasestorage.app",messagingSenderId:"413464866352",appId:"1:413464866352:web:61294a4121d0b0b28887f5"}),n=(0,r.aU)(l),d=(0,i.xI)(l)},1567:(e,a,s)=>{"use strict";s.d(a,{cn:()=>i});var t=s(3463),r=s(9795);function i(){for(var e=arguments.length,a=Array(e),s=0;s<e;s++)a[s]=arguments[s];return(0,r.QP)((0,t.$)(a))}}},e=>{var a=a=>e(e.s=a);e.O(0,[992,523,753,31,405,786,441,517,358],()=>a(7225)),_N_E=e.O()}]);