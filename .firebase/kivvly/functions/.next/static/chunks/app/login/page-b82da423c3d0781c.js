(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{7225:(e,a,s)=>{Promise.resolve().then(s.bind(s,8143))},8143:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>C});var t=s(5155),r=s(2115),i=s(6046),l=s(399),n=s(7058),o=s(9904),d=s(3415),c=s(4595),u=s(3312),m=s(3900),f=s(8986),g=s(9749),x=s(8629),p=s(1567);let h=x.bL,v=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(x.B8,{ref:a,className:(0,p.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...r})});v.displayName=x.B8.displayName;let y=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(x.l9,{ref:a,className:(0,p.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...r})});y.displayName=x.l9.displayName;let b=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(x.UC,{ref:a,className:(0,p.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...r})});b.displayName=x.UC.displayName;var j=s(9506);let w=d.z.object({registerName:d.z.string().min(3,"Name must be at least 3 characters."),registerEmail:d.z.string().email("Invalid email address."),registerPassword:d.z.string().regex(/^(?=.*[A-Za-z])(?=.*\d).{8,}$/,"Password must be at least 8 characters including 1 digit.")});async function N(e,a){console.log('(Mock) Sending code "'.concat(a,'" to email: ').concat(e))}function C(){let e=(0,i.useRouter)(),[a,s]=(0,r.useState)(!1),[x,p]=(0,r.useState)(null),[C,F]=(0,r.useState)(null),[P,k]=(0,r.useState)(""),[E,S]=(0,r.useState)(""),[R,B]=(0,r.useState)(1),[A,z]=(0,r.useState)(""),[I,J]=(0,r.useState)(""),[_,L]=(0,r.useState)(""),[O,$]=(0,r.useState)(""),[q,D]=(0,r.useState)(""),G=async a=>{a.preventDefault(),s(!0),p(null),F(null);try{let a=(await (0,l.x9)(c.j,P,E)).user,s=(0,n.H9)(c.db,"users",a.uid),t=await (0,n.x7)(s);if(t.exists()&&t.data().isBanned){await (0,l.CI)(c.j),p("Your account has been banned.");return}e.push("/")}catch(e){e instanceof o.g?p(e.message||"Failed to log in. Please try again."):e instanceof Error?p(e.message||"Failed to log in. Please try again."):p("Failed to log in. Please try again.")}finally{s(!1)}},U=async()=>{s(!0),p(null),F(null);try{if(!P)throw Error("Please enter your email in the Email field first.");await (0,l.J1)(c.j,P),F("A password reset link has been sent to your email.")}catch(e){e instanceof Error?p(e.message||"Failed to send password reset. Please try again."):p("Failed to send password reset. Please try again.")}finally{s(!1)}},Z=async e=>{e.preventDefault(),s(!0),p(null),F(null);try{w.parse({registerName:A,registerEmail:I,registerPassword:_});let e=Math.floor(1e5+9e5*Math.random()).toString();D(e),await N(I,e),F("A verification code has been sent to your email."),B(2)}catch(e){e instanceof d.G?p(e.issues[0].message):e instanceof Error?p(e.message||"Failed to send code. Please try again."):p("Failed to send code. Please try again.")}finally{s(!1)}},H=async a=>{if(a.preventDefault(),s(!0),p(null),F(null),O!==q){p("Invalid code. Please try again."),s(!1);return}try{let a=(await (0,l.eJ)(c.j,I,_)).user;await (0,l.r7)(a,{displayName:A}),await (0,n.BN)((0,n.H9)(c.db,"users",a.uid),{email:I,displayName:A,avatarUrl:"https://via.placeholder.com/128?text=No+Avatar",isBanned:!1,createdAt:(0,n.O5)()}),F("Registration successful! You can now log in."),e.push("/")}catch(e){e instanceof o.g?p(e.message||"Failed to create an account."):e instanceof Error?p(e.message||"Failed to create an account."):p("Failed to create an account.")}finally{s(!1)}},M=async()=>{s(!0),p(null),F(null);try{if(!I)throw Error("Please enter your email in the registration form before requesting a password reset.");await (0,l.J1)(c.j,I),F("A password reset link has been sent to the registration email.")}catch(e){e instanceof Error?p(e.message||"Failed to send password reset. Please try again."):p("Failed to send password reset. Please try again.")}finally{s(!1)}},T=async()=>{s(!0),p(null),F(null);try{let a=new l.HF,s=(await (0,l.df)(c.j,a)).user,t=s.displayName||"No Name";t.length>10&&(t=t.slice(0,10));let r=(0,n.H9)(c.db,"users",s.uid),i=await (0,n.x7)(r);if(i.exists()){if(i.data().isBanned){await (0,l.CI)(c.j),p("Your account has been banned.");return}await (0,n.BN)(r,{updatedAt:(0,n.O5)()},{merge:!0})}else await (0,n.BN)(r,{email:s.email,displayName:t,avatarUrl:s.photoURL||"https://via.placeholder.com/128?text=No+Avatar",isBanned:!1,createdAt:(0,n.O5)()});e.push("/")}catch(e){e instanceof o.g?p(e.message||"Failed to log in with Google."):e instanceof Error?p(e.message||"Failed to log in with Google."):p("Failed to log in with Google.")}finally{s(!1)}};return(0,t.jsx)("div",{className:"relative w-full h-screen flex flex-col",children:(0,t.jsx)("div",{className:"flex-grow flex items-center justify-center bg-gray-100",children:(0,t.jsxs)(g.Zp,{className:"w-[400px]",children:[(0,t.jsxs)(g.aR,{children:[(0,t.jsx)(g.ZB,{children:"Welcome"}),(0,t.jsx)(g.BT,{children:"Login or create an account to get started."})]}),(0,t.jsxs)(g.Wu,{children:[x&&(0,t.jsx)("div",{className:"mb-4",children:(0,t.jsx)("p",{className:"text-red-600 text-sm",children:x})}),C&&(0,t.jsx)("p",{className:"text-green-600 text-sm mb-4",children:C}),(0,t.jsxs)(h,{defaultValue:"login",className:"w-full",children:[(0,t.jsxs)(v,{className:"grid w-full grid-cols-2",children:[(0,t.jsx)(y,{value:"login",children:"Login"}),(0,t.jsx)(y,{value:"register",children:"Register"})]}),(0,t.jsx)(b,{value:"login",children:(0,t.jsxs)("form",{onSubmit:G,children:[(0,t.jsxs)("div",{className:"grid gap-4",children:[(0,t.jsxs)("div",{className:"flex flex-col space-y-1.5",children:[(0,t.jsx)(f.J,{htmlFor:"loginEmail",children:"Email"}),(0,t.jsx)(m.p,{id:"loginEmail",type:"email",placeholder:"Enter your email",value:P,onChange:e=>k(e.target.value),required:!0})]}),(0,t.jsxs)("div",{className:"flex flex-col space-y-1.5",children:[(0,t.jsx)(f.J,{htmlFor:"loginPassword",children:"Password"}),(0,t.jsx)(m.p,{id:"loginPassword",type:"password",placeholder:"Enter your password",value:E,onChange:e=>S(e.target.value),required:!0})]})]}),(0,t.jsx)(u.$,{className:"w-full mt-6",type:"submit",disabled:a,children:a?"Logging in...":"Login"}),(0,t.jsx)("div",{className:"text-center mt-2",children:(0,t.jsx)("button",{type:"button",onClick:U,disabled:a,className:"text-sm text-blue-600 underline",children:"Forgot your password?"})}),(0,t.jsxs)("div",{className:"relative my-4",children:[(0,t.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,t.jsx)("span",{className:"w-full border-t"})}),(0,t.jsx)("div",{className:"relative flex justify-center text-xs uppercase",children:(0,t.jsx)("span",{className:"bg-background px-2 text-muted-foreground",children:"Or continue with"})})]}),(0,t.jsx)("div",{className:"flex flex-col space-y-2",children:(0,t.jsxs)(u.$,{variant:"outline",type:"button",onClick:T,disabled:a,children:[(0,t.jsx)(j.F4b,{className:"mr-2 h-4 w-4"}),"Google"]})})]})}),(0,t.jsx)(b,{value:"register",children:1===R?(0,t.jsxs)("form",{onSubmit:Z,children:[(0,t.jsxs)("div",{className:"grid gap-4",children:[(0,t.jsxs)("div",{className:"flex flex-col space-y-1.5",children:[(0,t.jsx)(f.J,{htmlFor:"registerName",children:"Name"}),(0,t.jsx)(m.p,{id:"registerName",placeholder:"Minimum 3 characters",value:A,onChange:e=>z(e.target.value),required:!0})]}),(0,t.jsxs)("div",{className:"flex flex-col space-y-1.5",children:[(0,t.jsx)(f.J,{htmlFor:"registerEmail",children:"Email"}),(0,t.jsx)(m.p,{id:"registerEmail",type:"email",placeholder:"Enter your email",value:I,onChange:e=>J(e.target.value),required:!0})]}),(0,t.jsxs)("div",{className:"flex flex-col space-y-1.5",children:[(0,t.jsx)(f.J,{htmlFor:"registerPassword",children:"Password"}),(0,t.jsx)(m.p,{id:"registerPassword",type:"password",placeholder:"Password must be at least 8 characters including 1 digit.",value:_,onChange:e=>L(e.target.value),required:!0})]})]}),(0,t.jsx)(u.$,{className:"w-full mt-6",type:"submit",disabled:a,children:a?"Please wait...":"Send verification code"}),(0,t.jsx)("div",{className:"text-center mt-2",children:(0,t.jsx)("button",{type:"button",onClick:M,disabled:a,className:"text-sm text-blue-600 underline",children:"Forgot your password?"})}),(0,t.jsxs)("div",{className:"relative my-4",children:[(0,t.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,t.jsx)("span",{className:"w-full border-t"})}),(0,t.jsx)("div",{className:"relative flex justify-center text-xs uppercase",children:(0,t.jsx)("span",{className:"bg-background px-2 text-muted-foreground",children:"Or continue with"})})]}),(0,t.jsx)("div",{className:"flex flex-col space-y-2",children:(0,t.jsxs)(u.$,{variant:"outline",type:"button",onClick:T,disabled:a,children:[(0,t.jsx)(j.F4b,{className:"mr-2 h-4 w-4"}),"Google"]})})]}):(0,t.jsxs)("form",{onSubmit:H,children:[(0,t.jsx)("div",{className:"grid gap-4",children:(0,t.jsxs)("div",{className:"flex flex-col space-y-1.5",children:[(0,t.jsx)(f.J,{htmlFor:"verificationCode",children:"Verification Code"}),(0,t.jsx)(m.p,{id:"verificationCode",placeholder:"Enter the 6-digit code",value:O,onChange:e=>$(e.target.value),required:!0})]})}),(0,t.jsx)(u.$,{className:"w-full mt-6",type:"submit",disabled:a,children:a?"Creating account...":"Verify & Create Account"})]})})]})]}),(0,t.jsx)(g.wL,{className:"flex justify-center",children:(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"By continuing, you agree to our Terms of Service and Privacy Policy."})})]})})})}},3312:(e,a,s)=>{"use strict";s.d(a,{$:()=>d});var t=s(5155),r=s(2115),i=s(2317),l=s(1027),n=s(1567);let o=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef((e,a)=>{let{className:s,variant:r,size:l,asChild:d=!1,...c}=e,u=d?i.DX:"button";return(0,t.jsx)(u,{className:(0,n.cn)(o({variant:r,size:l,className:s})),ref:a,...c})});d.displayName="Button"},9749:(e,a,s)=>{"use strict";s.d(a,{BT:()=>d,Wu:()=>c,ZB:()=>o,Zp:()=>l,aR:()=>n,wL:()=>u});var t=s(5155),r=s(2115),i=s(1567);let l=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,i.cn)("rounded-xl border bg-card text-card-foreground shadow",s),...r})});l.displayName="Card";let n=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",s),...r})});n.displayName="CardHeader";let o=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,i.cn)("font-semibold leading-none tracking-tight",s),...r})});o.displayName="CardTitle";let d=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,i.cn)("text-sm text-muted-foreground",s),...r})});d.displayName="CardDescription";let c=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,i.cn)("p-6 pt-0",s),...r})});c.displayName="CardContent";let u=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,i.cn)("flex items-center p-6 pt-0",s),...r})});u.displayName="CardFooter"},3900:(e,a,s)=>{"use strict";s.d(a,{p:()=>l});var t=s(5155),r=s(2115),i=s(1567);let l=r.forwardRef((e,a)=>{let{className:s,type:r,...l}=e;return(0,t.jsx)("input",{type:r,className:(0,i.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:a,...l})});l.displayName="Input"},8986:(e,a,s)=>{"use strict";s.d(a,{J:()=>d});var t=s(5155),r=s(2115),i=s(6195),l=s(1027),n=s(1567);let o=(0,l.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(i.b,{ref:a,className:(0,n.cn)(o(),s),...r})});d.displayName=i.b.displayName},4595:(e,a,s)=>{"use strict";s.d(a,{db:()=>n,j:()=>o});var t=s(9904),r=s(7058),i=s(399);let l=(0,t.Wp)({apiKey:"AIzaSyCzuXne1Zr8WXpmOkuu8cTaY4xMv53mQeQ",authDomain:"kivvly.firebaseapp.com",projectId:"kivvly",storageBucket:"kivvly.firebasestorage.app",messagingSenderId:"413464866352",appId:"1:413464866352:web:61294a4121d0b0b28887f5"}),n=(0,r.aU)(l),o=(0,i.xI)(l)},1567:(e,a,s)=>{"use strict";s.d(a,{cn:()=>i});var t=s(3463),r=s(9795);function i(){for(var e=arguments.length,a=Array(e),s=0;s<e;s++)a[s]=arguments[s];return(0,r.QP)((0,t.$)(a))}}},e=>{var a=a=>e(e.s=a);e.O(0,[992,523,753,31,405,786,441,517,358],()=>a(7225)),_N_E=e.O()}]);